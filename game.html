<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ë‚´ ì£¼ê±° ì·¨í–¥ ë°¸ëŸ°ìŠ¤ ê²Œì„ - í…Œë„ŒíŠ¸ ë…¸íŠ¸</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Jua&family=Noto+Sans+KR:wght@400;700&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
        }

        .font-jua {
            font-family: 'Jua', sans-serif;
        }

        .tap-effect:active {
            transform: scale(0.95);
            transition: transform 0.1s;
        }

        .fade-in {
            animation: fadeIn 0.4s ease-out forwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .progress-bar-fill {
            transition: width 0.3s ease-in-out;
        }

        /* Glassmorphism for Result */
        .glass-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
    </style>
    <script src="js/config.js"></script>
</head>

<body class="bg-indigo-50 text-slate-900 h-screen overflow-hidden flex flex-col items-center justify-center">

    <!-- Screen 1: Start -->
    <div id="start-screen"
        class="w-full max-w-md h-full flex flex-col p-8 bg-white shadow-2xl relative items-center justify-center text-center">
        <div
            class="absolute top-0 left-0 w-full h-1/2 bg-gradient-to-b from-indigo-100 to-white -z-10 rounded-b-[3rem]">
        </div>

        <div class="mb-6 animate-bounce">
            <span class="text-6xl">ğŸ¡</span>
        </div>

        <h1 class="text-4xl font-jua text-indigo-600 mb-4 leading-tight">
            ë‚´ ì£¼ê±° ì„±í–¥<br>
            <span class="text-slate-800">MBTI í…ŒìŠ¤íŠ¸</span>
        </h1>
        <p class="text-slate-500 mb-10 text-lg">16ê°€ì§€ ìœ í˜•ìœ¼ë¡œ ë¶„ì„í•˜ëŠ”<br>ì†Œë¦„ë‹ëŠ” ë‚´ ì§‘ ì°¾ê¸° ìŠ¤íƒ€ì¼</p>

        <button onclick="startGame()"
            class="tap-effect w-full max-w-xs bg-indigo-600 text-white text-xl font-bold py-4 rounded-2xl shadow-lg hover:bg-indigo-700 transition-all flex items-center justify-center gap-2">
            í…ŒìŠ¤íŠ¸ ì‹œì‘í•˜ê¸° <i class="fa-solid fa-arrow-right"></i>
        </button>

        <p class="mt-4 text-xs text-slate-400">ì°¸ì—¬ììˆ˜: 12,453ëª…</p>
    </div>

    <!-- Screen 2: Game (Questions) -->
    <div id="game-screen" class="hidden w-full max-w-md h-full flex flex-col bg-slate-50 shadow-2xl relative">
        <!-- Header -->
        <div class="px-6 pt-12 pb-4 bg-white rounded-b-3xl shadow-sm z-10">
            <div class="flex justify-between items-end mb-2">
                <span class="text-indigo-600 font-black text-xl italic" id="q-counter-text">Q1</span>
                <span class="text-slate-300 text-xs font-bold">Total 16</span>
            </div>
            <div class="w-full bg-slate-100 h-3 rounded-full overflow-hidden">
                <div id="progress-bar" class="progress-bar-fill bg-indigo-500 h-full w-[0%] rounded-full relative">
                    <div class="absolute right-0 top-0 bottom-0 w-2 bg-white/30"></div>
                </div>
            </div>
        </div>

        <!-- Question -->
        <div class="flex-1 flex flex-col items-center justify-center p-6" id="question-container">
            <h2 id="question-text"
                class="text-2xl font-bold text-center leading-relaxed break-keep text-slate-800 mb-10 font-jua">
                ì§ˆë¬¸ í…ìŠ¤íŠ¸...
            </h2>

            <div class="w-full space-y-4">
                <!-- Option A -->
                <button onclick="selectOption(0)"
                    class="group tap-effect w-full bg-white border-2 border-indigo-50 hover:border-indigo-500 hover:bg-indigo-50 p-6 rounded-2xl shadow-sm hover:shadow-md transition-all text-left relative overflow-hidden">
                    <div
                        class="absolute top-3 left-3 w-6 h-6 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center font-bold text-xs group-hover:bg-indigo-500 group-hover:text-white transition-colors">
                        A</div>
                    <span id="btn-text-a"
                        class="text-lg font-bold text-slate-700 group-hover:text-indigo-700 leading-snug block pl-6">
                        ì„ íƒì§€ A
                    </span>
                </button>

                <!-- Option B -->
                <button onclick="selectOption(1)"
                    class="group tap-effect w-full bg-white border-2 border-slate-50 hover:border-pink-500 hover:bg-pink-50 p-6 rounded-2xl shadow-sm hover:shadow-md transition-all text-left relative overflow-hidden">
                    <div
                        class="absolute top-3 left-3 w-6 h-6 rounded-full bg-slate-100 text-slate-500 flex items-center justify-center font-bold text-xs group-hover:bg-pink-500 group-hover:text-white transition-colors">
                        B</div>
                    <span id="btn-text-b"
                        class="text-lg font-bold text-slate-700 group-hover:text-pink-700 leading-snug block pl-6">
                        ì„ íƒì§€ B
                    </span>
                </button>
            </div>
        </div>
    </div>

    <!-- Screen 3: Result -->
    <div id="result-screen"
        class="hidden w-full max-w-md h-full flex flex-col bg-white shadow-2xl relative overflow-y-auto">
        <div
            class="relative w-full h-48 bg-indigo-600 flex items-center justify-center shrink-0 rounded-b-[3rem] -mb-16 z-0">
            <div class="text-center text-white pb-10">
                <p class="text-sm opacity-80 mb-1">ë‚˜ì˜ ì£¼ê±° ì„±í–¥ì€?</p>
                <h1 class="text-3xl font-jua tracking-wide" id="result-type-name">ìœ í˜• ì´ë¦„</h1>
            </div>
        </div>

        <div class="px-6 pb-12 z-10 flex-1 flex flex-col">
            <!-- Card -->
            <div class="glass-card bg-white rounded-3xl p-6 shadow-xl mb-6 text-center animate-fade-in-up">
                <div class="text-6xl mb-4" id="result-emoji">ğŸ˜</div>
                <h2 id="result-title" class="text-xl font-bold text-indigo-900 mb-2"></h2>
                <div class="w-full h-0.5 bg-indigo-50 my-4"></div>
                <p id="result-desc" class="text-slate-600 leading-relaxed font-medium break-keep text-sm">
                    ê²°ê³¼ ì„¤ëª… í…ìŠ¤íŠ¸...
                </p>
                <div class="mt-4 flex flex-wrap gap-2 justify-center" id="result-tags">
                    <!-- Tags injected here -->
                </div>
            </div>

            <!-- Other Types Section -->
            <div id="other-types-section" class="mt-6 mb-8 w-full hidden animate-fade-in-up">
                <h3 class="text-xs font-bold text-slate-400 text-center mb-4">ë‹¤ë¥¸ 15ê°€ì§€ ìœ í˜•ë„ êµ¬ê²½í•´ë´ìš”! ğŸ‘€</h3>
                <div id="other-types-grid" class="grid grid-cols-4 gap-2">
                    <!-- Injected via JS -->
                </div>
            </div>

            <!-- Actions -->
            <div class="space-y-3 mt-auto">
                <button onclick="goToMap()"
                    class="tap-effect w-full bg-indigo-600 text-white font-bold py-4 rounded-xl shadow-lg hover:bg-indigo-700 flex items-center justify-center gap-2">
                    <i class="fa-solid fa-map-location-dot"></i>
                    ë‚´ ë§ì¶¤ ë™ë„¤ ì§€ë„ ë³´ê¸°
                </button>

                <button onclick="shareResult()"
                    class="tap-effect w-full bg-slate-100 text-slate-700 font-bold py-3.5 rounded-xl hover:bg-slate-200 flex items-center justify-center gap-2">
                    <i class="fa-solid fa-share-nodes"></i>
                    ì¹œêµ¬ì—ê²Œ ê³µìœ í•˜ê¸°
                </button>

                <button onclick="location.reload()" class="w-full py-3 text-slate-400 text-sm hover:text-indigo-500">
                    <i class="fa-solid fa-rotate-right mr-1"></i> ë‹¤ì‹œ í…ŒìŠ¤íŠ¸í•˜ê¸°
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script>
        // --- 1. Constants & Data ---
        // Axes: safety, traffic, infra, cost, nature, quality

        const PERSONAS = [
            { id: 'safety_guard', name: "ì²­ì™€ëŒ€ ê²½í˜¸ì‹¤ì¥í˜•", emoji: "ğŸ‘®â€â™‚ï¸", desc: "ì•ˆì „ì´ ìµœìš°ì„ ! ì§‘ ê°€ëŠ” ê¸¸ ì¹˜ì•ˆ ë“±ê¸‰ë¶€í„° ë°©ë²”ì°½ ìœ ë¬´ê¹Œì§€ ê¼¼ê¼¼íˆ ì²´í¬í•˜ëŠ” ë‹¹ì‹ . ë§ˆìŒ í¸íˆ ê¿€ì  ì˜ ìˆ˜ ìˆëŠ” ìš”ìƒˆ ê°™ì€ ì§‘ì´ í•„ìš”í•´ìš”.", traits: { safety: 10, quality: 5 } },
            { id: 'traffic_teleport', name: "ìˆœê°„ì´ë™ ëŠ¥ë ¥ìí˜•", emoji: "âš¡", desc: "ì—­ì„¸ê¶Œì´ ê³§ ë³µì§€ë‹¤! ì§€í•˜ì² ì—­ ë„ë³´ 5ë¶„ ì»· ì•„ë‹ˆë©´ ì™¸ì¶œì„ ê±°ë¶€í•˜ëŠ” íš¨ìœ¨ ì¤‘ì‹¬íŒŒ. ì¶œí‡´ê·¼ ì‹œê°„ ë‹¨ì¶•ì´ ì¸ìƒì˜ ëª©í‘œì‹œêµ°ìš”.", traits: { traffic: 10, infra: 5 } },
            { id: 'infra_cvs', name: "í”„ë¡œ í¸ì˜ì  ëŸ¬ë²„í˜•", emoji: "ğŸª", desc: "ìŠ¬ë¦¬í¼ ì‹ ê³  ëª¨ë“  ê±¸ í•´ê²°í•´ì•¼ ì§ì„±ì´ í’€ë¦¬ëŠ” íƒ€ì…. í¸ì˜ì , ì½”ì¸ì„¸íƒì†Œ, ë‹¤ì´ì†Œê°€ ë‚´ ì§‘ ëƒ‰ì¥ê³ ê³  ë“œë ˆìŠ¤ë£¸ì´ì£ .", traits: { infra: 10, cost: 5 } },
            { id: 'cost_saver', name: "ì‹¤ì†íŒŒ ê°“ìƒëŸ¬í˜•", emoji: "ğŸ’°", desc: "ì ë§Œ ìëŠ” ë°©ì— ëˆ ì“°ê¸° ì‹«ì–´! ì›”ì„¸ë¥¼ ì•„ê»´ì„œ íˆ¬ìí•˜ê³  ë¯¸ë˜ë¥¼ ì¤€ë¹„í•˜ëŠ” ì•¼ë§ê°€. ê°€ì„±ë¹„ ì¢‹ì€ ìˆ¨ì€ ë³´ì„ì„ ì°¾ì•„ë‚´ëŠ” ëŠ¥ë ¥ì´ íƒì›”í•´ìš”.", traits: { cost: 10, traffic: 5 } },
            { id: 'infra_edu', name: "ëŒ€ì¹˜ë™ í•™ì›ê°€ ë“œë¦¬í”„íŠ¸í˜•", emoji: "ğŸ“", desc: "ë§¹ëª¨ì‚¼ì²œì§€êµ! ë‚´ ì§ì¥ë³´ë‹¤ ì•„ì´ í•™ì› ìœ„ì¹˜ê°€ ë” ì¤‘ìš”í•œ êµìœ¡ì—´ ë§Œë ™ ë¶€ëª¨ë‹˜. í•™êµ° ì¢‹ê³  ìœ í•´ì‹œì„¤ ì—†ëŠ” í´ë¦°í•œ ë™ë„¤ë¥¼ ì„ í˜¸í•´ìš”.", traits: { infra: 8, safety: 7, nature: -2 } },
            { id: 'nature_hermit', name: "ìˆ²ì„¸ê¶Œ ì€ë‘” ê³ ìˆ˜í˜•", emoji: "ğŸŒ²", desc: "ì°½ë¬¸ ì—´ë©´ ë²½ë·°ëŠ” ì§ˆìƒ‰! ìˆ²ë·°, ê³µì›ë·°ë¥¼ ë³´ë©° íë§í•´ì•¼ í•˜ëŠ” ìì—°ì¸. ë„ì‹¬ ì†ì—ì„œë„ ìƒˆì†Œë¦¬ë¥¼ ë“¤ì„ ìˆ˜ ìˆëŠ” ìˆ²ì„¸ê¶Œì„ ì°¾ì•„ë‹¤ë‹ˆë„¤ìš”.", traits: { nature: 10, traffic: -2 } },
            { id: 'infra_food', name: "ë°°ë‹¬ì˜ë¯¼ì¡± VVIPí˜•", emoji: "ğŸ›µ", desc: "ë§›ì§‘ ë°°ë‹¬ ì•ˆ ë˜ëŠ” ì§€ì—­ì€ ìœ ë°°ì§€ë‚˜ ë‹¤ë¦„ì—†ìŒ. ë°°ë‹¬ë¹„ 0ì› êµ¬ì—­ê³¼ ë¨¹ìê³¨ëª© ê·¼ì²˜ë¥¼ ì‚¬ë‘í•˜ëŠ” ì§„ì •í•œ ë¯¸ì‹ê°€!", traits: { infra: 8, cost: 2 } },
            { id: 'traffic_gangnam', name: "ê°•ë‚¨í–‰ êµë‘ë³´ í—Œí„°í˜•", emoji: "ğŸ™ï¸", desc: "ëª¸í…Œí¬í•´ì„œë¼ë„ ê°•ë‚¨ ì§„ì…ì„ ë…¸ë¦°ë‹¤! ê°•ë‚¨ ì ‘ê·¼ì„±ì´ ì¢‹ë‹¤ë©´ ë‚¡ì€ ë¹Œë¼ë„ OK. ì„±ê³µì„ í–¥í•´ ë‹¬ë¦¬ëŠ” ë‹¹ì‹ ì˜ ì—´ì •ì„ ì‘ì›í•©ë‹ˆë‹¤.", traits: { traffic: 9, cost: -5, quality: -2 } },
            { id: 'nature_active', name: "í•œê°•ê³µì› ëŸ¬ë‹ í¬ë£¨í˜•", emoji: "ğŸƒ", desc: "í•œê°• ëŸ¬ë‹ ëª» í•˜ë©´ ê·¼ì†ì‹¤ ì˜¤ëŠ” íƒ€ì…. ìš´ë™í•˜ê¸° ì¢‹ê³  ì‚°ì±…ë¡œê°€ ì˜ ì •ë¹„ëœ ìˆ˜ë³€ ê³µì› ê·¼ì²˜ê°€ ë‹¹ì‹ ì˜ ë¡œë§ í•˜ìš°ìŠ¤!", traits: { nature: 9, infra: 5 } },
            { id: 'quality_option', name: "í’€ì˜µì…˜ ë¯¸ë‹ˆë©€ë¦¬ìŠ¤íŠ¸í˜•", emoji: "ğŸ§³", desc: "ê°€êµ¬ ì‚´ ëˆë„, ì‹œê°„ë„ ì•„ê¹ë‹¤! ëª¸ë§Œ ë“¤ì–´ê°€ë©´ í•´ê²°ë˜ëŠ” í’€ì˜µì…˜ ì‹ ì¶• ì˜¤í”¼ìŠ¤í…”ì„ ì„ í˜¸í•˜ëŠ” ì‹¬í”Œ ë¼ì´í”„ ì¶”êµ¬ì.", traits: { quality: 9, cost: -2 } },
            { id: 'quality_parking', name: "ì£¼ì°¨ì¥ ë³´ì•ˆ ìš”ì›í˜•", emoji: "ğŸš—", desc: "ë‚´ ì°¨ ê¸íˆë©´ ì „ìŸì´ì•¼! ê¸°ê³„ì‹ ì£¼ì°¨ëŠ” NO, ìì£¼ì‹ ì£¼ì°¨ì¥ 1.2ëŒ€ ì´ìƒ í•„ìˆ˜. ì°¨ë¥¼ ë”ì°ì´ ì•„ë¼ëŠ” ì˜¤ë„ˆ ë“œë¼ì´ë²„.", traits: { quality: 8, traffic: 5 } },
            { id: 'quality_sound', name: "í”„ë¡œ ì§‘ì½•ëŸ¬í˜•", emoji: "ğŸ§", desc: "ì§‘ì€ ìµœê³ ì˜ íœ´ì‹ì²˜. ì¸µê°„ì†ŒìŒì€ ì ˆëŒ€ ìš©ë‚© ëª» í•´! ë°©ìŒ ì˜ ë˜ê³  ì¡°ìš©í•œ ì£¼íƒê°€ì—ì„œ ë‚˜ë§Œì˜ ì‹œê°„ì„ ì¦ê¸°ê³  ì‹¶ì–´í•´ìš”.", traits: { quality: 10, infra: -2 } },
            { id: 'safety_community', name: "ìš°ë¦¬ ë™ë„¤ ë³´ì•ˆê´€í˜•", emoji: "ğŸ‘®â€â™€ï¸", desc: "ë°¤ê¸¸ ë¬´ì„œìš´ ê±´ ë”± ì§ˆìƒ‰. 24ì‹œê°„ ê²½ë¹„ì›ì´ ìƒì£¼í•˜ê³  ì»¤ë®¤ë‹ˆí‹° ì¹˜ì•ˆì´ í™•ì‹¤í•œ ëŒ€ë‹¨ì§€ë‚˜ ì˜¤í”¼ìŠ¤í…”ì„ ì„ í˜¸í•˜ì‹œë„¤ìš”.", traits: { safety: 9, infra: 6 } },
            { id: 'quality_new', name: "ê°€ì„±ë¹„ ì‹ ë„ì‹œ ì´ì£¼ë¯¼í˜•", emoji: "ğŸ—ï¸", desc: "ì„œìš¸ì˜ ë‚¡ì€ ë¹Œë¼ ì‚¬ëŠë‹ˆ ê²½ê¸°ë„ ì‹ ì¶• ì•„íŒŒíŠ¸ ê°„ë‹¤! ì¾Œì í•œ ì£¼ê±° í™˜ê²½ê³¼ ë„“ì€ í‰ìˆ˜ë¥¼ ì¤‘ìš”í•˜ê²Œ ìƒê°í•˜ëŠ” ì‹¤ë¦¬íŒŒ.", traits: { quality: 9, traffic: -5 } },
            { id: 'infra_living', name: "1ì¸ ê°€êµ¬ ì„¸íƒ ìš”ì •í˜•", emoji: "ğŸ§º", desc: "ë¹¨ë˜ë°©, ìˆ˜ì„ ì§‘, 24ì‹œ ë§ˆíŠ¸ê°€ ê°€ê¹Œì›Œì•¼ í•´! í˜¼ì ì‚´ì•„ë„ ë¶ˆí¸í•¨ ì—†ì´ ì‚´ ìˆ˜ ìˆëŠ” ìƒí™œ ë°€ì°©í˜• ì¸í”„ë¼ë¥¼ ì¤‘ìš”ì‹œí•´ìš”.", traits: { infra: 9, safety: 3 } },
            { id: 'quality_community', name: "ì»¤ë®¤ë‹ˆí‹° ì •ë³µìí˜•", emoji: "ğŸŠ", desc: "ìˆ˜ì˜ì¥, í—¬ìŠ¤ì¥, ë…ì„œì‹¤ ë”¸ë¦° ì•„íŒŒíŠ¸ê°€ ë‚´ ë¡œë§. ì§‘ ë°–ìœ¼ë¡œ ì•ˆ ë‚˜ê°€ë„ ë‹¨ì§€ ë‚´ì—ì„œ ëª¨ë“  ê±¸ í•´ê²°í•˜ê³  ì‹¶ì€ ë¦¬ì¡°íŠ¸ì¡±.", traits: { quality: 10, nature: 5 } }
        ];

        const QUESTIONS = [
            // Q1: Safety
            {
                q: "ì§‘ì„ êµ¬í•  ë•Œ ë” ë§ˆìŒì´ ê°€ëŠ” ë¬¸êµ¬ëŠ”?",
                a: { text: "CCTVÂ·í˜„ê´€ ë³´ì•ˆ ì™„ë²½ (ì•ˆì‹¬ ê·€ê°€)", scores: { safety: 5, quality: 2 } },
                b: { text: "ë°¤ëŠ¦ê²Œê¹Œì§€ í•«í•œ í™í”Œë ˆì´ìŠ¤", scores: { infra: 5, safety: -2 } }
            },
            // Q2: Traffic
            {
                q: "ì•„ì¹¨ ì¶œê·¼ê¸¸, ë‚˜ì˜ í—ˆìš© ë²”ìœ„ëŠ”?",
                a: { text: "ì§€ì˜¥ì²  30ë¶„ ì„œì„œ ê°€ê¸° (ì‹œê°„ ë‹¨ì¶•)", scores: { traffic: 5, quality: -2 } },
                b: { text: "ì•‰ì•„ì„œ 1ì‹œê°„ ê°€ê¸° (í¸ì•ˆí•¨)", scores: { quality: 3, traffic: -5 } }
            },
            // Q3: Infra
            {
                q: "ì£¼ë§ ì ì‹¬, ë°¥ ë¨¹ìœ¼ëŸ¬ ë‚˜ê°ˆ ë•Œ",
                a: { text: "ìŠ¬ë¦¬í¼ ì‹ ê³  3ë¶„ ì»· í¸ì˜ì /ë¶„ì‹ì§‘", scores: { infra: 5 } },
                b: { text: "ì°¨ íƒ€ê³  ë‚˜ê°€ì„œ ë§›ì§‘ íƒë°©", scores: { quality: 2, traffic: 2 } }
            },
            // Q4: Cost vs Quality
            {
                q: "ì›”ì„¸ 10ë§Œì› ë” ë‚´ë©´?",
                a: { text: "ì‹ ì¶• í’€ì˜µì…˜, ëª¸ë§Œ ì˜¤ì„¸ìš”", scores: { quality: 5, cost: -5 } },
                b: { text: "ì¢€ ë‚¡ì•˜ì§€ë§Œ ì €ì¶• ê°€ëŠ¥, ê°“ì„±ë¹„", scores: { cost: 5, quality: -2 } }
            },
            // Q5: Nature
            {
                q: "ì°½ë¬¸ì„ ì—´ì—ˆì„ ë•Œ ë³´ì´ëŠ” ë·°ëŠ”?",
                a: { text: "íƒ íŠ¸ì¸ ê³µì›/ìˆ² ë·° (íë§)", scores: { nature: 5, traffic: -2 } },
                b: { text: "í™”ë ¤í•œ ì‹œí‹°ë·° (ì„±ê³µì˜ ë§›)", scores: { traffic: 3, infra: 2 } }
            },
            // Q6: Safety vs Cost
            {
                q: "ê³¨ëª©ê¸¸ ê°€ë¡œë“±ì´ ì–´ë‘¡ë‹¤ë©´?",
                a: { text: "ì ˆëŒ€ ê³„ì•½ ì•ˆ í•¨. ë¬´ì„œì›Œ!", scores: { safety: 5 } },
                b: { text: "ì›”ì„¸ ì‹¸ë©´ ë­... í•¸ë“œí° ë¶ˆ ì¼œì§€", scores: { cost: 5, safety: -2 } }
            },
            // Q7: Traffic (Gangnam)
            {
                q: "ì¹œêµ¬ ì•½ì†, ì£¼ë¡œ ì–´ë””ì„œ ì¡ì•„?",
                a: { text: "ê°•ë‚¨/í™ëŒ€ ë¬´ì¡°ê±´ í•«í”Œ", scores: { traffic: 5, infra: 2 } },
                b: { text: "ìš°ë¦¬ ë™ë„¤ í™ˆíŒŒí‹° or ì¡°ìš©í•œ ê³³", scores: { quality: 3, infra: -2 } }
            },
            // Q8: Quality (Noise)
            {
                q: "ê°€ì¥ ì°¸ì„ ìˆ˜ ì—†ëŠ” ê²ƒì€?",
                a: { text: "ìœ—ì§‘ ì¿µì¿µ ì¸µê°„ì†ŒìŒ", scores: { quality: 5 } },
                b: { text: "ì§‘ ì• ë„ë¡œ ì°¨ ì†Œë¦¬", scores: { nature: 2, traffic: -2 } }
            },
            // Q9: Infra (Food)
            {
                q: "ë°°ë‹¬ ì–´í”Œì„ ì¼°ëŠ”ë° 'ë°°ë‹¬ ë¶ˆê°€' ì§€ì—­ì´ë¼ë©´?",
                a: { text: "ë‹¹ì¥ ì´ì‚¬ ê°„ë‹¤", scores: { infra: 5 } },
                b: { text: "ì§ì ‘ í•´ë¨¹ìœ¼ë©´ ë˜ì§€ ë­ (ìš”ë¦¬ì™•)", scores: { cost: 2 } }
            },
            // Q10: Quality (Option vs Space)
            {
                q: "ë‘˜ ì¤‘ í•˜ë‚˜ë§Œ ì„ íƒí•œë‹¤ë©´?",
                a: { text: "ì¢ì•„ë„ ì‹ ì¶•+í’€ì˜µì…˜", scores: { quality: 5, cost: -2 } },
                b: { text: "êµ¬ì¶•ì´ë¼ë„ ìš´ë™ì¥ë§Œí•œ ë°©", scores: { cost: 3, quality: -2 } }
            }, // Space mapped to Cost/Value here or distinct? Let's use Cost for space efficiency
            // Q11: Nature (Active)
            {
                q: "í‡´ê·¼ í›„ ë‚˜ì˜ ë£¨í‹´ì€?",
                a: { text: "ì§‘ ê·¼ì²˜ ê³µì› ëŸ¬ë‹/ì‚°ì±…", scores: { nature: 5, quality: 2 } },
                b: { text: "ë„·í”Œë¦­ìŠ¤ ë³´ë©´ì„œ ë’¹êµ´ë’¹êµ´", scores: { quality: 3, infra: 2 } }
            },
            // Q12: Quality (Parking)
            {
                q: "ì°¨ê°€ ìˆëŠ”ë° ì£¼ì°¨ì¥ì´ ì—†ë‹¤ë©´?",
                a: { text: "ê³µì˜ì£¼ì°¨ì¥ ì•Œì•„ë³¸ë‹¤", scores: { cost: 3 } },
                b: { text: "ê·¸ ì§‘ì— ì–´ë–»ê²Œ ì‚´ì•„? ì ˆëŒ€ ë¶ˆê°€", scores: { quality: 5 } }
            },
            // Q13: Safety (Community)
            {
                q: "1ì¸µ ê³µë™í˜„ê´€ ë³´ì•ˆë¬¸ì´ ê³ ì¥ ë‚¬ë‹¤ë©´?",
                a: { text: "íƒë°° ë°›ê¸° í¸í•˜ê³  ì¢‹ë„¤ (ê¸ì •ì™•)", scores: { infra: 2, safety: -3 } },
                b: { text: "ë¶ˆì•ˆí•´ì„œ ì§‘ì£¼ì¸ì—ê²Œ ë°”ë¡œ ì „í™”", scores: { safety: 5 } }
            },
            // Q14: Quality (Community)
            {
                q: "ëŒ€ë‹¨ì§€ ì•„íŒŒíŠ¸ ì»¤ë®¤ë‹ˆí‹° ì‹œì„¤ (í—¬ìŠ¤ì¥, ë…ì„œì‹¤)",
                a: { text: "ìˆìœ¼ë©´ ë¬´ì¡°ê±´ ì“´ë‹¤. ë¡œë§ì„", scores: { quality: 5, cost: -2 } },
                b: { text: "ê´€ë¦¬ë¹„ë§Œ ë¹„ì‹¸ì§€... ì•ˆ ì”€", scores: { cost: 5 } }
            },
            // Q15: Traffic vs Nature
            {
                q: "ì–¸ë• ìœ„ì— ìˆëŠ” ë·° ë§›ì§‘",
                a: { text: "ë§¤ì¼ ë“±ì‚°? ì ˆëŒ€ ëª» í•´", scores: { traffic: 5 } },
                b: { text: "ë·°ê°€ ê¹¡íŒ¨ë‹¤. ë‚­ë§Œ ì„ íƒ", scores: { nature: 5, traffic: -3 } }
            },
            // Q16: Final
            {
                q: "ë¶€ë™ì‚° êµ¬í•  ë•Œ 1ìˆœìœ„ í•„í„°ëŠ”?",
                a: { text: "ê°€ê²© (ë³´ì¦ê¸ˆ/ì›”ì„¸)", scores: { cost: 8 } },
                b: { text: "ìœ„ì¹˜ (ì—­ì„¸ê¶Œ/ì•ˆì „)", scores: { traffic: 4, safety: 4 } }
            }
        ];

        // --- 2. State & Logic ---
        let currentStep = 0;
        let userScores = { safety: 0, traffic: 0, infra: 0, cost: 0, nature: 0, quality: 0 };

        function startGame() {
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('game-screen').classList.remove('hidden');
            renderQuestion();
        }

        function renderQuestion() {
            const q = QUESTIONS[currentStep];

            // Progress Bar
            const progress = ((currentStep + 1) / QUESTIONS.length) * 100;
            document.getElementById('progress-bar').style.width = `${progress}%`;
            document.getElementById('q-counter-text').innerText = `Q${currentStep + 1}`;

            // Content
            const container = document.getElementById('question-container');
            container.classList.remove('fade-in');
            void container.offsetWidth; // Reflow
            container.classList.add('fade-in');

            document.getElementById('question-text').innerText = q.q;
            document.getElementById('btn-text-a').innerText = q.a.text;
            document.getElementById('btn-text-b').innerText = q.b.text;
        }

        function selectOption(idx) {
            const q = QUESTIONS[currentStep];
            const choice = idx === 0 ? q.a : q.b;

            // Accumulate Scores
            for (const [key, val] of Object.entries(choice.scores)) {
                if (userScores[key] !== undefined) {
                    userScores[key] += val;
                }
            }

            currentStep++;
            if (currentStep < QUESTIONS.length) {
                renderQuestion();
            } else {
                finishGame();
            }
        }

        function finishGame() {
            document.getElementById('game-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');

            // Calculate Best Match
            // Logic: Compare user score vector with persona trait vector
            // Similarity = -Distance (Euclidean)
            // Or simple weighted sum? 
            // Let's use: Score(Persona) = Sum(User[trait] * Persona[trait])
            // This emphasizes traits that both user and persona value high.

            let bestPersona = null;
            let maxScore = -Infinity;

            PERSONAS.forEach(p => {
                let score = 0;
                for (const [trait, weight] of Object.entries(p.traits)) {
                    // If user has high score in this trait, add to score
                    const userVal = userScores[trait] || 0;
                    score += userVal * weight;
                }

                if (score > maxScore) {
                    maxScore = score;
                    bestPersona = p;
                }
            });

            // Render Result
            document.getElementById('result-type-name').innerText = bestPersona.name;
            document.getElementById('result-title').innerText = bestPersona.desc.split('.')[0] + ".";
            document.getElementById('result-desc').innerText = bestPersona.desc;
            document.getElementById('result-emoji').innerText = bestPersona.emoji;

            // Generate Tags
            const tagsDiv = document.getElementById('result-tags');
            tagsDiv.innerHTML = '';
            const topTraits = Object.entries(bestPersona.traits)
                .sort(([, a], [, b]) => b - a)
                .slice(0, 3);

            topTraits.forEach(([t, v]) => {
                let label = t.toUpperCase();
                if (t === 'safety') label = '#ì•ˆì „ì œì¼';
                if (t === 'traffic') label = '#ì—­ì„¸ê¶Œ';
                if (t === 'infra') label = '#ìŠ¬ì„¸ê¶Œ';
                if (t === 'cost') label = '#ê°€ì„±ë¹„';
                if (t === 'nature') label = '#ìˆ²ì„¸ê¶Œ';
                if (t === 'quality') label = '#ì‹ ì¶•/ì˜µì…˜';

                const span = document.createElement('span');
                span.className = "bg-indigo-50 text-indigo-600 px-3 py-1 rounded-full text-xs font-bold";
                span.innerText = label;
                tagsDiv.appendChild(span);
            });

            window.resultId = bestPersona.id;
            renderOtherTypes(bestPersona.id);
        }

        function renderOtherTypes(currentId) {
            const grid = document.getElementById('other-types-grid');
            const section = document.getElementById('other-types-section');
            if (!grid || !section) return;

            const others = PERSONAS.filter(p => p.id !== currentId);

            grid.innerHTML = others.map(item => `
                <div onclick="showPreview('${item.id}')" class="flex flex-col items-center justify-center p-2 bg-white rounded-xl shadow-sm border border-slate-100 cursor-pointer hover:scale-105 hover:shadow-md transition-all active:scale-95">
                    <span class="text-2xl mb-1 filter drop-shadow-sm">${item.emoji}</span>
                    <span class="text-[0.6rem] font-bold text-slate-500 text-center leading-tight break-keep">${item.name.replace('í˜•', '')}</span>
                </div>
            `).join('');

            section.classList.remove('hidden');
        }

        function showPreview(id) {
            // Simple preview mechanism: just alert or reload for now, 
            // or we could swap the result card content. 
            // For MVP, let's swap the content to show that type.
            const p = PERSONAS.find(item => item.id === id);
            if (p) {
                document.getElementById('result-type-name').innerText = p.name;
                document.getElementById('result-title').innerText = p.desc.split('.')[0] + ".";
                document.getElementById('result-desc').innerText = p.desc;
                document.getElementById('result-emoji').innerText = p.emoji;

                // Re-render tags
                const tagsDiv = document.getElementById('result-tags');
                tagsDiv.innerHTML = '';
                const topTraits = Object.entries(p.traits).sort(([, a], [, b]) => b - a).slice(0, 3);
                topTraits.forEach(([t, v]) => {
                    let label = t.toUpperCase();
                    if (t === 'safety') label = '#ì•ˆì „ì œì¼';
                    if (t === 'traffic') label = '#ì—­ì„¸ê¶Œ';
                    if (t === 'infra') label = '#ìŠ¬ì„¸ê¶Œ';
                    if (t === 'cost') label = '#ê°€ì„±ë¹„';
                    if (t === 'nature') label = '#ìˆ²ì„¸ê¶Œ';
                    if (t === 'quality') label = '#ì‹ ì¶•/ì˜µì…˜';
                    const span = document.createElement('span');
                    span.className = "bg-indigo-50 text-indigo-600 px-3 py-1 rounded-full text-xs font-bold";
                    span.innerText = label;
                    tagsDiv.appendChild(span);
                });

                window.resultId = p.id; // Update mapping for "Go To Map"
                renderOtherTypes(p.id); // Re-render grid to exclude new current

                // Scroll to top
                document.getElementById('result-screen').scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function goToMap() {
            // Find numeric ID (1~16) based on index
            // reviews.html expects type=1..16
            const index = PERSONAS.findIndex(p => p.id === window.resultId);
            const numericId = index + 1;

            // Redirect with type parameter
            window.location.href = `reviews.html?type=${numericId}`;
        }

        function shareResult() {
            if (navigator.share) {
                navigator.share({
                    title: 'ë‚´ ì£¼ê±° ì„±í–¥ MBTI',
                    text: `ë‚˜ëŠ” ${document.getElementById('result-type-name').innerText}! ë„ˆë„ í•œë²ˆ í•´ë´.`,
                    url: window.location.href
                });
            } else {
                alert("ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!");
            }
        }

    </script>
</body>

</html>